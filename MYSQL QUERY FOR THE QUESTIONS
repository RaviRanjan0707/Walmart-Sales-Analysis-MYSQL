-- --------------GENERIC ---


-- How many unique cities does the data have?

SELECT DISTINCT
    city
FROM
    sales;

-- or -----

SELECT 
    city
FROM
    sales
GROUP BY city;


--  In which city is each branch --
 
SELECT DISTINCT
    city, branch
FROM
    sales;


-- ------- PRODUCT -------

-- How many unique product lines does the data have? --

SELECT 
    count(DISTINCT product_line)
FROM
    sales;

--  What is the most common payment method? -- 

SELECT 
    payment, COUNT(payment) AS count
FROM
    sales
GROUP BY payment
ORDER BY count DESC;


-- What is the most selling product line? --

SELECT 
    product_line, COUNT(product_line) AS count
FROM
    sales
GROUP BY product_line
ORDER BY count DESC
LIMIT 1;

-- What is the total revenue by month? --

SELECT 
    month_name, SUM(total) AS revenue
FROM
    sales
GROUP BY month_name
ORDER BY revenue DESC;


-- What month had the largest COGS  --

SELECT 
    month_name, SUM(cogs) AS COGS
FROM
    sales
GROUP BY month_name
ORDER BY COGS DESC
LIMIT 1;


-- What product line had the largest revenue? -- 

SELECT 
    product_line, SUM(total) AS revenue
FROM
    sales
GROUP BY product_line
ORDER BY revenue DESC
LIMIT 1;


-- What is the city with the largest revenue? --

select city, sum(total) as revenue
from sales
group by city
order by revenue desc limit 1;


-- Which product line had the largest VAT --

SELECT 
    product_line, SUM(tax_pct) AS VAT
FROM
    sales
GROUP BY product_line
ORDER BY VAT DESC
LIMIT 1;


-- Fetch each product line and add a column to those product line  
-- showing "Good", "Bad". Good if its greater than average sales -- 











--  Which branch sold more products than average product sold? -- 

SELECT 
    branch, AVG(quantity) AS avg
FROM
    sales
GROUP BY branch
HAVING SUM(quantity) > (SELECT 
        AVG(quantity)
    FROM
        sales)
ORDER BY AVG(quantity) DESC;


-- What is the most common product line by gender? -- 

SELECT 
    gender, product_line, COUNT(gender) AS count
FROM
    sales
GROUP BY gender , product_line
ORDER BY COUNT(gender) DESC;


-- What is the average rating of each product line? -- 

SELECT 
    product_line, AVG(rating) AS avg
FROM
    sales
GROUP BY product_line
ORDER BY avg DESC;





-- -------- SALES -----

-- Number of sales made in each time of the day per weekday--

SELECT 
    day_name, time_of_day, COUNT(invoice_id) AS sales
FROM
    sales
GROUP BY day_name , time_of_day
ORDER BY sales DESC;


-- Which of the customer types brings the most revenue? --

SELECT 
    customer_type, avg(total) as revenue
FROM
    sales
GROUP BY customer_type
ORDER BY revenue DESC
LIMIT 1;


-- Which city has the largest tax percent/ VAT (Value Added Tax)? -- 

SELECT 
    city, AVG(tax_pct) AS VAT
FROM
    sales
GROUP BY city
ORDER BY VAT DESC
LIMIT 1;


-- Which customer type pays the most in VAT?--

SELECT 
    customer_type, SUM(tax_pct) AS VAT
FROM
    sales
GROUP BY customer_type
ORDER BY VAT DESC
LIMIT 1;

